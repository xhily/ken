---
slug: nextjs-router-progress
draft: true
---

å“ˆå–½ï¼Œæˆ‘æ˜¯æ¥·é¹ã€‚

å…ˆæ¥çœ‹ä¸€ä¸ªåé¢æ•™æã€‚

åœ¨ Dify.ai ä¸­ï¼Œå½“ç‚¹å‡»è·³è½¬é¡µé¢ä¹‹åï¼Œä¼šæœ‰ä¸€æ®µéœ€è¦ç­‰å¾…çš„æ—¶é—´ï¼Œç„¶åæ‰ä¼šè·³è½¬é¡µé¢ã€‚

ç„¶è€Œï¼Œä¸­é—´è¿™æ®µæ—¶é—´æˆ‘å¹¶ä¸çŸ¥é“æ˜¯å¦è·³è½¬æˆåŠŸäº†ï¼Œæˆ‘ä¼šå¤šç‚¹äº†å‡ ä¸‹ï¼Œç›´åˆ°è·³è½¬ã€‚

è¿™ç§ä½“éªŒå¾ˆä¸å¥½ ğŸ‘

è§£å†³æ–¹æ¡ˆå¾ˆç®€å•ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ GitHub çš„è·³è½¬äº¤äº’ã€‚

å®ƒä¼šåœ¨è·³è½¬ä¹‹å‰ï¼Œæ˜¾ç¤ºä¸€ä¸ªè¿›åº¦æ¡ï¼Œæ¸…æ™°åœ°å‘Šè¯‰ç”¨æˆ·ï¼Œæˆ‘æ­£åœ¨è·³è½¬ï¼Œè¯·ç¨ç­‰ã€‚

é‚£ä¹ˆåœ¨ Next.js ä¸­ï¼Œå¦‚ä½•å®ç°è¿™ä¸ªæ•ˆæœå‘¢ï¼Ÿ

æˆ‘ä»¬å¯ä»¥å€ŸåŠ© [BProgress](https://bprogress.vercel.app/) æ¥å®ç°ã€‚

å…ˆå®‰è£…ä¾èµ–ï¼š

```bash
npm install @bprogress/next
```

æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨æ ¹å¸ƒå±€ `app/layout.tsx` ä¸­å¼•å…¥ï¼š

```tsx {4,14-21}
'use client';

import "./globals.css";
import { ProgressProvider } from '@bprogress/next/app';

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en">
      <body>
        <ProgressProvider
          height="4px"
          color="#0000ff"
          options={{ showSpinner: false }}
          shallowRouting
          >
          {children}
        </ProgressProvider>
      </body>
    </html>
  );
}
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°ï¼Œåœ¨é¦–é¡µå’Œç™»å½•é¡µã€ç™»å½•é¡µå’Œæ³¨å†Œé¡µä¹‹é—´è·³è½¬ï¼Œéƒ½ä¼šæ˜¾ç¤ºä¸€ä¸ªè¿›åº¦æ¡ã€‚

// TODO

ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬ç™»å½•æˆåŠŸä¹‹åï¼Œå†ç‚¹å‡»è·³è½¬ï¼Œç¼ºä¸ä¼šæ˜¾ç¤ºè¿›åº¦æ¡ã€‚

è¿™æ˜¯å› ä¸ºï¼Œé¦–é¡µå’Œç™»å½•é¡µã€ç™»å½•é¡µå’Œæ³¨å†Œé¡µä¹‹é—´ï¼Œæ˜¯ä½¿ç”¨ `<Link>` ç»„ä»¶è¿›è¡Œè·³è½¬çš„ã€‚

BProgress ä¼šç»™æ‰€æœ‰ `<Link>` ç»„ä»¶æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œç„¶åæ˜¾ç¤ºè¿›åº¦æ¡ã€‚

// TODO

ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬ç™»å½•æˆåŠŸä¹‹åï¼Œåˆ™æ˜¯ä½¿ç”¨ `router.push` è¿›è¡Œè·³è½¬çš„ã€‚

BProgress ä¸ä¼šç»™ `router.push` æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œè‡ªç„¶ä¸ä¼šæ˜¾ç¤ºè¿›åº¦æ¡ã€‚

ä¸ç”¨æ…Œï¼Œæˆ‘ä»¬æ”¹ä¸º BProgress æä¾›çš„ `useRouter` å°±å¯ä»¥å•¦ã€‚

```tsx
// import { useRouter } from 'next/navigation';
import { useRouter } from '@bprogress/next/app';
```

è¿™æ˜¯ï¼Œä½ å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ç™»å½•æˆåŠŸä¹‹åï¼Œå†ç‚¹å‡»è·³è½¬ï¼Œå°±ä¼šæ˜¾ç¤ºè¿›åº¦æ¡äº†ã€‚

// TODO

ä½†å¦‚æœä½ çš„é¡¹ç›®å·²ç»å°è£…è¿‡äº†è‡ªå·±çš„ `useRouter`ï¼Œé‚£ä¹ˆä½ å¯ä»¥å°†å…¶ä½œä¸ºå‚æ•° `customRouter`ä¼ å…¥è¿›è¡ŒäºŒæ¬¡å°è£…ï¼š

```tsx {6}
import { useRouter } from '@bprogress/next/app';
import { useRouter as useNextIntlRouter } from '@/i18n/navigation';

export default function Home() {
  const router = useRouter({
    customRouter: useNextIntlRouter,
  });

  return (
    <button
      onClick={() =>
        router.push('/about', {
          startPosition: 0.3,
          locale: 'en',
        })
      }
    >
      Go to about page
    </button>
  );
}
```

æœ€åï¼Œæˆ‘å·²ä¸Šä¼ åˆ°ä»“åº“ï¼š[nextjs-progress-bar-demo](https://github.com/wukaipeng-dev/nextjs-progress-bar-demo)ã€‚







